<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Introduction to ggplot2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Q&Q</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Seminar1final.html">Introduction to R</a>
</li>
<li>
  <a href="Seminar2finalfinal.html">Functions, loops, conditions</a>
</li>
<li>
  <a href="Seminar_3_-_Resharing_data___Descriptive_Statistics.html">Reshaping Data &amp; Descriptive Stats</a>
</li>
<li>
  <a href="Introduction_to_ggplot2.html">ggplot2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to ggplot2</h1>

</div>


<pre class="r"><code>library(&quot;data.table&quot;)
library(&quot;ggplot2&quot;)</code></pre>
<pre class="r"><code>da &lt;- fread(&quot;files/character-deaths.csv&quot;)
bat &lt;- fread(&quot;files/battles.csv&quot;)
da$Gender &lt;- factor(da$Gender,labels = c(&quot;Female&quot;, &quot;Male&quot;))</code></pre>
<div id="introduction-to-ggplot2" class="section level1">
<h1>Introduction to ggplot2</h1>
<p>You already know <code>plot()</code> function for simple visualizations. It’s time to take the whole power of R graphics with external package <code>ggplot2</code>!</p>
<p><code>ggplot</code> stands for “Grammar of Graphics” plot: it is a famous book by L. Wilkinson where you can find an outstanding theory about translation your data in graphics. This book is not about creation fancy plots. It is more about “grammar” or rules of visualization based on object-oriented design and some math. I recommend you this book if you like such things or want to understand <code>ggplot</code> and SPSS graphics better (yes, this “Grammar of Graphics” is also realized in modern versions of SPSS too).</p>
</div>
<div id="example-0-pie-chart-is-a-bar-plot-in-polar-coordinate-system" class="section level1">
<h1>Example 0: Pie chart is a bar plot in polar coordinate system</h1>
<p>We have already talked about different charts: scatterplots, boxplots etc. However, according to Wilkinson, thinking in terms of charts can limit our capabilities to create graphics. He gives an interesting example: the “Pie Chart” that you of course now is just a bar plot in polar coordinate system.</p>
<pre class="r"><code>pie &lt;- ggplot(data = da, aes(x = &quot;&quot;, fill = factor(Gender)))+
  geom_bar(width = 1, position = &quot;fill&quot;, color = &quot;black&quot;)
pie</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<pre class="r"><code>pie + coord_polar(theta = &quot;y&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-3-2.png" width="768" /></p>
<p>Think about it!</p>
</div>
<div id="basic-ggplot2-concepts" class="section level1">
<h1>Basic ggplot2 concepts</h1>
<p>There are several abstract concepts that you need to understand to master <code>ggplot2</code>. First of all, it is <strong>layers</strong>. Each component of your graph (underlying data it’s plotting, coordinate system, legend, title, additional lines etc.) are separate layers.</p>
<p>“Aesthetics, in the original Greek sense, offers principles for relating sensory attributes (color, shape, sound, etc.) to abstractions.” (from “Grammar of Graphics”). In <code>ggplot2</code> <strong>aesthetics</strong> (function <code>aes()</code>) are some elements of your plot that are somehow associated with data: - x position - y position - size of elements - shape of elements - color of elements</p>
<p><strong>Geometries (geoms)</strong> are actual graphical elements utilized in a plot. For example: - points - lines - line segments - bars - text</p>
<p>Some of these geometries have their own aesthetics, for example, for points and lines you can set up different types.</p>
<p><strong>Statistics</strong> is another important layer type. Sometimes you want to plot frequencies or some other things that you need to calculate before plotting. There are two major ways to do that:</p>
<ul>
<li>Calculate everything before plotting</li>
<li>Use special layers to calculate some statistics. For this situation you need to use special layers (or parameters in geometries) to calculate it. Some of them are applied by default, e.g. when you want to plot bars.</li>
</ul>
<p>Moreover, you can plot smoothing and regression lines, central tendencies and variability on your plot.</p>
</div>
<div id="example-1.-scatterplot-attackers-army-vs.defenders-army" class="section level1">
<h1>Example 1. Scatterplot: Attacker’s army vs. Defender’s army</h1>
<p>First, we need to create <strong>data layer</strong>. You need to use function <code>ggplot()</code> with two important parameters:</p>
<ul>
<li><code>data</code> - dataset you want to plot (data.frame or data.table)</li>
<li><code>aes()</code> - aes is a function and take as arguments columns of your data.frame/data.table. Indeed, you can leave this empty and specify <code>aes()</code> for every geom individually. Otherwise, geoms will inherit <code>aes()</code> from the main <code>ggplot()</code> function.</li>
</ul>
<p>Let’s create this data layer for our <code>bat</code> dataset and set <code>attacker_size</code> and <code>defender_size</code> as aesthetics.</p>
<pre class="r"><code>ggplot(data = bat, aes(x = attacker_size, y = defender_size))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
<p>Our current plot is empty. We need to specify <em>geometry</em>. The best way to plot two continuous variables is scatter plot <code>geom_point()</code>. Each point of scatter plot represents the case with two values: x and y. We need to use ‘+’ operator to add additional layer to a ggplot:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point()</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>Technically, <code>geom_point()</code> is a function. It has many parameters but it will inherit essential parameters (<code>data</code> and <code>aes()</code>) from <code>ggplot()</code> (unless they are specified inside <code>geom_point()</code>).</p>
<p>Our scatterplot is very boring and not really informative. First, let’s change colour to…hm… purple. I like purple!</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(colour = &quot;purple&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>And make points bigger.</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(colour = &quot;purple&quot;, size = 3)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
<p>I don’t like circles.</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(colour = &quot;purple&quot;, size = 3, shape = 8)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<p>For now our scatterplot is less boring but it is still not informative.</p>
<p>Let’s add some colours based on battle outcome. It means that colour changes depending on some variable. It means that we need to specify <em>aesthetics</em>:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<p>We can also add labels. For example, <code>attacker_king</code> column with additional layer:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
<p>Hm… We need to move these lebels a little bit and delete overlapping labels:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3, hjust = -0.2, check_overlap = TRUE)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
<p>Not ideal, but it is much better.</p>
<p>Let’s try to add some summary statistics on the plot:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3, hjust = -0.2, check_overlap = T)+
  geom_smooth()</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
<p>Rather ugly =( We have very few points and variability is very high.</p>
<p>We need to garnish our scatter plot.</p>
<p>First, I want to rescale this plot and change limits for x and y axes. There are many ways to do it, but I recommend you to use <code>coord_cartesian()</code> function with <code>xlim</code> and <code>ylim</code> parameters. you need to specify vector with two numbers for each parameter (limits for each axis).</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3, hjust = -0.2, check_overlap = T)+
  coord_cartesian(xlim = c(0, 100000), ylim = c(0, 100000) )</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="768" /></p>
<p>Ahhhggrrrhhh, the battle at Castle Black spoils everything! If we set other limits, we will skip this point:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3, hjust = -0.2, check_overlap = T)+
  coord_cartesian(xlim = c(0, 25000), ylim = c(0, 25000) )</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="768" /></p>
<p>Also, we need to change title and axes names. As usual, you have different ways to do it. I recommend you function <code>labs()</code> with parameters <code>title</code>, <code>x</code>, <code>y</code>:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3, hjust = -0.2, check_overlap = T)+
  coord_cartesian(xlim = c(0, 25000), ylim = c(0, 25000) )+
  labs(title = &quot;Example 1. GoT battles: army sizes and outcome&quot;, 
       x = &quot;Defender&#39;s army&quot;,
       y = &quot;Attacker&#39;s army&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="768" /></p>
<p>…and change a legend:</p>
<pre class="r"><code>ggplot(data = bat, aes(x = defender_size, y = attacker_size))+
  geom_point(aes(colour = attacker_outcome), size = 3, shape = 8)+
  geom_text(aes(label = location), size = 3, hjust = -0.2, check_overlap = T)+
  coord_cartesian(xlim = c(0, 25000), ylim = c(0, 25000) )+
  labs(title = &quot;Example 1. GoT battles: army sizes and outcome&quot;, 
       x = &quot;Defender&#39;s army&quot;,
       y = &quot;Attacker&#39;s army&quot;)+
  scale_colour_discrete(name=&quot;Outcome&quot;,
                         labels=c(&quot;Unknown&quot;,&quot;Defender&#39;s win&quot;, &quot;Attacker&#39;s win&quot;))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
<p>Note: you need to use functions <code>scale_fill_manual</code>, <code>scale_colour_hue</code>, <code>scale_colour_manual</code>, <code>scale_shape_discrete</code>, <code>scale_linetype_discrete</code> etc. depending on your variables. Therefore, changing legends can be very frustrating.</p>
</div>
<div id="example-2.-bar-plot-males-vs.females-in-game-of-thrones" class="section level1">
<h1>Example 2. Bar plot: Males vs. Females in Game of Thrones</h1>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar()</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="768" /></p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
   geom_bar(aes(fill = Gender))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-18-1.png" width="768" /></p>
<p>Fill is not the same as colour!</p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;, stat = &quot;count&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-19-1.png" width="768" /></p>
<p>For bars, densities, hidtograms etc. <code>colour</code> changes a colour for border lines and <code>fill</code> - colour of figure.</p>
<p>Let’s add a title:</p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;)+
  labs(title = &quot;Example 2. Number of males and females&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-20-1.png" width="768" /></p>
<p>… and rotate our graphic:</p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;)+
  labs(title = &quot;Example 2. Number of males and females&quot;)+
  coord_flip()</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-21-1.png" width="768" /></p>
<p>It is interesting to plot gender by different houses:</p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;)+
  labs(title = &quot;Example 2. Number of males and females&quot;)+
  coord_flip()+
  facet_wrap(~Allegiances)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-22-1.png" width="768" /></p>
<p>Default ggplot2 graphics is very nice. Nevertheless, it has much more parameters that you can adjust. To change “deeper” parameters of ggplot2 graphics (like background, size and style of titles etc.) you need to modify <code>theme</code>.</p>
<p>To understand variety of theme parameters you can try some built-in themes:</p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;, position = position_dodge(0.9))+
  labs(title = &quot;Example 2. Number of males and females&quot;)+
  coord_flip()+
  theme_classic()</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-23-1.png" width="768" /></p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;, position = position_dodge(0.9))+
  labs(title = &quot;Example 2. Number of males and females&quot;)+
  coord_flip()+
  theme_bw()</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-24-1.png" width="768" /></p>
<p>Moreover, we can modify theme with <code>theme()</code> function. It is rather challanging due to large numbers of parameters that you can change. Moreover, some parameters are more general; more specific parameters will inherit general parameters. For more information check help for <code>theme()</code>: <code>?theme</code></p>
<p>Let’s make our graphic crazy!</p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;, position = position_dodge(0.9))+
  labs(title = &quot;Example 2. Number of males and females&quot;)+
  coord_flip()#+</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-25-1.png" width="768" /></p>
<pre class="r"><code>  #theme(line = element_line(colour = &quot;red&quot;,linetype = 2, size = 3),
  #      rect = element_rect(colour = &quot;blue&quot;, fill = &quot;purple&quot;, size = 4),
  #      text = element_text(face = &quot;bold.italic&quot;, colour = &quot;green&quot;, size = 30, angle = 5),
  #      panel.background = element_rect(colour = &quot;red&quot;, fill = &quot;brown&quot;))</code></pre>
<p><strong>Even more crazy!!!</strong></p>
<pre class="r"><code>ggplot(da, aes(x = Gender))+ 
  geom_bar(aes(fill = Gender), colour = &quot;grey20&quot;, position = position_dodge(0.9))+
  labs(title = &quot;Example 2. Number of males and females&quot;)+
  coord_flip()#+</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-26-1.png" width="768" /></p>
<pre class="r"><code>  #theme(line = element_line(colour = &quot;red&quot;,linetype = 2, size = 3),
  #      rect = element_rect(colour = &quot;blue&quot;, fill = &quot;purple&quot;, size = 4),
  #      text = element_text(face = &quot;bold.italic&quot;, colour = &quot;green&quot;, size = 30, angle = 5),
  #      panel.background = element_rect(colour = &quot;red&quot;, fill = &quot;brown&quot;),
  #      text = element_text(face = &quot;bold.italic&quot;, colour = &quot;green&quot;, size = 30, angle = 5),
  #      panel.background = element_rect(colour = &quot;green&quot;, fill = &quot;orange&quot;),
  #      plot.title = element_text(size = 20, colour = &quot;pink&quot;),
  #      axis.text = element_text(size = 20, colour = &quot;purple&quot;, angle = 45),
  #      axis.ticks = element_line(size = 5, colour = &quot;brown&quot;),
  #      axis.ticks.length = unit(.85, &quot;cm&quot;),
  #      legend.text  = element_text(colour=&quot;blue&quot;, size=16, face=&quot;bold&quot;),
  #      legend.position = &quot;bottom&quot;,
  #      legend.background = element_rect(colour = &quot;red&quot;, fill = &quot;orange&quot;),
  #      plot.background = element_rect(colour = &quot;#FF9911&quot;, fill = &quot;yellow&quot;))</code></pre>
<p>Ha-aha-ha-ahaha! HAHAHAHAHAH! Ha! Hm… Sorry.</p>
</div>
<div id="example-3.-histogram-density-violin-army-size-distributions" class="section level1">
<h1>Example 3. Histogram, density, violin: army size distributions</h1>
<p>Let’s plot a histogram for army sizes.</p>
<pre class="r"><code>batlong &lt;- melt(bat, measure.vars = c(&quot;attacker_size&quot;, &quot;defender_size&quot;),variable.name = &quot;battle_role&quot;, value.name = &quot;army_size&quot;)</code></pre>
<pre class="r"><code>ggplot(data = batlong, aes(x = army_size))+
  geom_histogram(bins = 50)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
<p>Let’s plot two histograms separately:</p>
<pre class="r"><code>ggplot(data = batlong, aes(x = army_size, fill = battle_role))+
  geom_histogram(bins = 50, position=&quot;identity&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-29-1.png" width="768" /></p>
<p>They are overlapping! Let’s make them transparent.</p>
<pre class="r"><code>ggplot(data = batlong, aes(x = army_size, fill = battle_role))+
  geom_histogram(bins = 50, alpha = 0.5, position=&quot;identity&quot;)</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-30-1.png" width="768" /></p>
<p>…and add title with appropriate legend:</p>
<pre class="r"><code>ggplot(data = batlong, aes(x = army_size, fill = battle_role))+
  geom_histogram(bins = 50, alpha = 0.5, position=&quot;identity&quot;)+
  labs(title = &quot;Example 3. GoT battles: Distribution of army sizes&quot;, 
       x = &quot;Army size&quot;,
       y = &quot;&quot;)+
  scale_fill_discrete(name=&quot;Battle role&quot;,
                         labels=c(&quot;Attacker&quot;,&quot;Defender&quot;))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-31-1.png" width="768" /></p>
<p>Instead of histogram(<code>geom_histogram()</code>) we can use density (<code>geom_density()</code>). It will create something like smoothed histograms:</p>
<pre class="r"><code>ggplot(data = batlong, aes(x = army_size, fill = battle_role))+
  geom_density(alpha = 0.5)+
  labs(title = &quot;Example 3. GoT battles: Distribution of army sizes&quot;, 
       x = &quot;Army size&quot;,
       y = &quot;&quot;)+
  scale_fill_discrete(name=&quot;Battle role&quot;,
                         labels=c(&quot;Attacker&quot;,&quot;Defender&quot;))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-32-1.png" width="768" /></p>
<p>Another popular geometry is violin. It is very similar to <code>geom_density()</code>, but rotated, reflected and demonstrated as independent figures.</p>
<pre class="r"><code>ggplot(data = batlong, aes(x = army_size, fill = battle_role))+
  geom_violin(aes(x = battle_role, y = army_size), alpha = 0.5)+
  labs(title = &quot;Example 3. GoT battles: Distribution of army sizes&quot;, 
       x = &quot;Army size&quot;,
       y = &quot;&quot;)+
  scale_fill_discrete(name=&quot;Battle role&quot;,
                         labels=c(&quot;Attacker&quot;,&quot;Defender&quot;))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-33-1.png" width="768" /></p>
<p><a href="http://eamoncaddigan.net/dataviz/r/psych/2015/09/26/violin-plots/">Many people think that violin plots are much better than box plot</a> - another popular graphic among psychologists. “Box and whiskers plot” is a rather convinient way to plot psychological data. The bottom and top of a box are the first and the trird quartile of plotted distribution (points that divide the first 25% and 75% of ranked data) and a line inside a box is the median (i.e. the second quartile). Whiskers represent… well, it varies. <a href="https://en.wikipedia.org/wiki/Box_plot">Wikipedia knows at least 5 possible variants for plotting whiskers</a>. Default parameters for <code>geom_boxplot()</code> whiskers you can find in help for this function:</p>
<blockquote>
<p>The upper whisker extends from the hinge to the highest value that is within 1.5 * IQR of the hinge, where IQR is the inter-quartile range, or distance between the first and third quartiles. The lower whisker extends from the hinge to the lowest value within 1.5 * IQR of the hinge. Data beyond the end of the whiskers are outliers and plotted as points (as specified by Tukey).</p>
</blockquote>
<p>In addition, we can combine violins and box plots! You need to add additional geometry <code>geom_boxplot()</code> for that:</p>
<pre class="r"><code>ggplot(data = batlong, aes(x = battle_role, y = army_size))+
  geom_violin(aes(fill =  battle_role), alpha = 0.5)+
  geom_boxplot(width = 0.3)+
  labs(title = &quot;Example 3. GoT battles: Distribution of army sizes&quot;, 
       x = &quot;Army size&quot;,
       y = &quot;&quot;)+
  scale_fill_discrete(name=&quot;Battle role&quot;,
                         labels=c(&quot;Attacker&quot;,&quot;Defender&quot;))</code></pre>
<p><img src="Introduction_to_ggplot2_files/figure-html/unnamed-chunk-34-1.png" width="768" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
